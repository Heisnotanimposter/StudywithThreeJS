<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Three.js Lighting Example</title>
    <script src="./three.js"></script> <!-- Import Three.js library -->
    <script src="./dat.gui.js"></script> <!-- Import dat.GUI for UI controls -->
    <script src="./OrbitControls.js"></script> <!-- Import OrbitControls for mouse-based camera control -->
    
    <style>
        body {
            margin: 0; /* Remove default margin */
            overflow: hidden; /* Hide overflow to ensure canvas takes full screen */
        }
    </style>
</head>
<body>
    <div id="webgl-output"></div> <!-- Div to hold the renderer's output -->
    <script>
        // Initialize the scene, camera, and renderer
        function init() {
            var scene = new THREE.Scene(); // Create a new scene
            var camera = new THREE.PerspectiveCamera(
                45, // Field of view
                window.innerWidth / window.innerHeight, // Aspect ratio
                0.1, // Near clipping plane
                1000 // Far clipping plane
            );
            const gui = new dat.GUI(); // Initialize the GUI control panel

            var renderer = new THREE.WebGLRenderer(); // Create a new WebGL renderer
            renderer.setClearColor(new THREE.Color(0x000000)); // Set background color
            renderer.setSize(window.innerWidth, window.innerHeight); // Set renderer size to full window
            renderer.shadowMap.enabled = true; // Enable shadows

            // Camera controls for mouse interaction (rotation, zoom, and pan)
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            camera.position.set(-20, 20, 20); // Set camera position
            controls.update(); // Update controls

            // Create the floor
            const pgeometry = new THREE.PlaneGeometry(15, 15); // Plane geometry with width and height
            const pmaterial = new THREE.MeshStandardMaterial({color: 0xcccccc}); // Material for the plane
            const plane = new THREE.Mesh(pgeometry, pmaterial); // Mesh combining geometry and material
            plane.rotation.x = 1.5 * Math.PI; // Rotate plane to lie flat
            plane.position.set(0, -1, 0); // Position the plane
            plane.receiveShadow = true; // Allow the plane to receive shadows
            scene.add(plane); // Add plane to the scene

            // Create a cube
            const cgeometry = new THREE.BoxGeometry(1, 1, 1); // Cube geometry
            const cmaterial = new THREE.MeshStandardMaterial({ color: 0x28b463 }); // Green material for the cube
            const cube = new THREE.Mesh(cgeometry, cmaterial); // Mesh combining geometry and material
            cube.castShadow = true; // Enable shadows for the cube
            scene.add(cube); // Add cube to the scene

            // Add a directional light
            const dlight = new THREE.DirectionalLight(0xffffff, 1); // White light with full intensity
            dlight.position.set(5, 5, 0); // Set light position
            dlight.castShadow = true; // Enable shadows
            scene.add(dlight); // Add to the scene
            gui.add(dlight, "visible").name("Directional Light"); // Add light visibility toggle in GUI

            // Helper for the directional light
            const dhelper = new THREE.DirectionalLightHelper(dlight, 5); // Visual helper for light direction
            scene.add(dhelper); // Add to the scene
            gui.add(dhelper, "visible").name("D-Light Helper"); // Add helper visibility toggle in GUI

            // Add a point light
            const plight = new THREE.PointLight(0xffffff, 1, 100, 1); // White point light with intensity and distance
            plight.position.set(-3, 1, 3); // Set light position
            plight.castShadow = true; // Enable shadows
            scene.add(plight); // Add to the scene
            gui.add(plight, "visible").name("Point Light"); // Add light visibility toggle in GUI

            // Helper for the point light
            const pointLightHelper = new THREE.PointLightHelper(plight, 1); // Helper to visualize point light
            scene.add(pointLightHelper); // Add to the scene
            gui.add(pointLightHelper, "visible").name("Point Light Helper"); // Add helper visibility toggle in GUI

            // Add a spotlight
            const slight = new THREE.SpotLight(0xffffff, 1); // Spotlight with white color and full intensity
            slight.position.set(0, 1, 5); // Set light position
            slight.castShadow = true; // Enable shadows
            scene.add(slight); // Add to the scene
            gui.add(slight, "visible").name("Spot Light"); // Add light visibility toggle in GUI

            // Helper for the spotlight
            const spotLightHelper = new THREE.SpotLightHelper(slight); // Helper to visualize spotlight
            scene.add(spotLightHelper); // Add to the scene
            gui.add(spotLightHelper, "visible").name("Spot Light Helper"); // Add helper visibility toggle in GUI

            // Add ambient light
            const alight = new THREE.AmbientLight(0xffff00, 1); // Yellow ambient light
            alight.visible = false; // Initially hidden
            scene.add(alight); // Add to the scene
            gui.add(alight, "visible").name("Ambient Light"); // Add light visibility toggle in GUI

            // Add hemisphere light
            const hlight = new THREE.HemisphereLight(0xf29886, 0x000000, 1); // Sky and ground light
            hlight.visible = false; // Initially hidden
            scene.add(hlight); // Add to the scene
            gui.add(hlight, "visible").name("Hemisphere Light"); // Add light visibility toggle in GUI

            // Helper for hemisphere light
            const hhelper = new THREE.HemisphereLightHelper(hlight, 5); // Visual helper for hemisphere light
            hhelper.visible = false; // Initially hidden
            scene.add(hhelper); // Add to the scene
            gui.add(hhelper, "visible").name("Hemisphere Light Helper"); // Add helper visibility toggle in GUI

            // Add rectangular area light
            const rlight = new THREE.RectAreaLight(0xffffff, 1, 20, 20); // Rectangular light with size and intensity
            rlight.position.set(5, 5, 0); // Set light position
            rlight.lookAt(0, 0, 0); // Point light towards the origin
            rlight.visible = false; // Initially hidden
            scene.add(rlight); // Add to the scene
            gui.add(rlight, "visible").name("Rect Area Light"); // Add light visibility toggle in GUI

            // Attach renderer output to the HTML element
            document.getElementById("webgl-output").appendChild(renderer.domElement);

            // Rendering function
            function renderScene() {
                controls.update(); // Update camera controls
                requestAnimationFrame(renderScene); // Continuously request animation frame
                renderer.render(scene, camera); // Render the scene from the camera's perspective
            }

            renderScene(); // Start rendering loop
        }

        window.onload = init; // Initialize when the window loads
    </script>
</body>
</html>